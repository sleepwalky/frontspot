<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="/manifest.json">
</head>
<body>
    <div id="mapid"></div>
    
    <script src="https://www.gstatic.com/firebasejs/4.12.1/firebase.js"></script>
    <script>
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyBMlTZY4Qj80TtmzGW7LrPE7flosoi4CxY",
            authDomain: "frontspot-37f84.firebaseapp.com",
            databaseURL: "https://frontspot-37f84.firebaseio.com",
            projectId: "frontspot-37f84",
            storageBucket: "",
            messagingSenderId: "74389515745"
        };
        firebase.initializeApp(config);

        // Retrieve Firebase Messaging object.
        var messaging = firebase.messaging();
        // Add the public key generated from the console here.
        messaging.usePublicVapidKey("BEM0zdkSb-QpTRInNaKPXRWB6ustw-QExwBNXDDa3r2lj-u18Nq1l7T_AbykvQ-0v0tPyGCB-O5c0PCfqZtRVwU");
        messaging.requestPermission().then(function() {
        console.log('Notification permission granted.');
        // TODO(developer): Retrieve an Instance ID token for use with FCM.
        // ...
        }).catch(function(err) {
        console.log('Unable to get permission to notify.', err);
        });

          // Get Instance ID token. Initially this makes a network call, once retrieved
            // subsequent calls to getToken will return from cache.
            messaging.getToken().then(function(currentToken) {
                if (currentToken) {
                sendTokenToServer(currentToken);
                updateUIForPushEnabled(currentToken);
                } else {
                // Show permission request.
                console.log('No Instance ID token available. Request permission to generate one.');
                // Show permission UI.
                updateUIForPushPermissionRequired();
                setTokenSentToServer(false);
                }
            }).catch(function(err) {
                console.log('An error occurred while retrieving token. ', err);
                showToken('Error retrieving Instance ID token. ', err);
                setTokenSentToServer(false);
            });
            // Callback fired if Instance ID token is updated.
        messaging.onTokenRefresh(function() {
        messaging.getToken().then(function(refreshedToken) {
            console.log('Token refreshed.');
            // Indicate that the new Instance ID token has not yet been sent to the
            // app server.
            setTokenSentToServer(false);
            // Send Instance ID token to app server.
            sendTokenToServer(refreshedToken);
            // ...
        }).catch(function(err) {
            console.log('Unable to retrieve refreshed token ', err);
            showToken('Unable to retrieve refreshed token ', err);
        });
        });
    </script>
</body>
</html>